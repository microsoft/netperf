import{r as u,j as e,H as G,T as B,B as v}from"./index-EmXvQbE1.js";import{G as k}from"./graph-view-LRaEpUIO.js";import{u as R,F as f,I as j,S as C,M as m,G as D}from"./app-website-visits-rnanueHQ.js";import{C as X}from"./Container-oFNj3BWu.js";const H=S=>{const{tcpiocp:n,quiciocp:s,tcpepoll:h,quicepoll:a,quicxdp:x,quicwsk:o,commitIndex:r}=S,c=["TCP + iocp","QUIC + iocp","TCP + epoll","QUIC + epoll","QUIC + winXDP","QUIC + wsk"],[b,q]=u.useState([]);let U=e.jsx("div",{});if(u.useEffect(()=>{console.log("FullLatCurve component mounted");const i=async(d,w)=>{try{const W=`https://raw.githubusercontent.com/microsoft/netperf/sqlite/full_latencies/full_curve_${d[w][1]}.json`;return await(await fetch(W)).json()}catch(F){return console.log(F),{Values:[],Percentiles:[]}}};n&&s&&h&&a&&x&&o&&(async()=>{const d=await Promise.all([i(n,n.length-r-1),i(s,s.length-r-1),i(h,h.length-r-1),i(a,a.length-r-1),i(x,x.length-r-1),i(o,o.length-r-1)]);q(d)})()},[n,s,h,a,x,o,r]),console.log(b),b){let i=[];for(let t of b)if(t.Percentiles.length>0){i=t.Percentiles,i=i.map(d=>d.toString());break}U=e.jsx(k,{title:"Full Curve Latency",subheader:"Curve is the minimum 0th percentile of 3 runs. Data truncated to 10,000 us",labels:i,series:b.map((t,d)=>({name:c[d],type:"line",fill:"solid",data:t.Values.map(w=>Math.min(w,1e4))}))})}return e.jsx(u.Fragment,{children:U})},K=H;let E=!1;document.addEventListener("mousedown",function(){E=!0});document.addEventListener("mouseup",function(){E=!1});function Z(){const S="https://raw.githubusercontent.com/microsoft/netperf/deploy/historical_latency_page.json",{data:n}=R(S),[s,h]=u.useState("azure"),[a,x]=u.useState("windows-2022-x64"),[o,r]=u.useState("ubuntu-20.04-x64"),[c,b]=u.useState("rps-up-512-down-4000"),[q,U]=u.useState(0),i=["50th percentile","90th percentile","99th percentile","99.9th percentile","99.99th percentile","99.999th percentile","99.9999th percentile"],[t,d]=u.useState(0),w=l=>{d(l.target.value)},F=l=>{U(l.target.value)};let W=e.jsx("div",{}),p=[],Q=[],V=[],$=[],y=[],I=[],L=[],P=[],T=[];n&&(p=n[`${a}-${s}-iocp-schannel`][`${c}-tcp`].data.slice().reverse(),Q=n[`${o}-${s}-epoll-openssl`][`${c}-tcp`].data.slice().reverse(),V=Array.from({length:Math.max(p.length,Q.length)},(l,g)=>g),$=n[`${a}-${s}-iocp-schannel`][`${c}-tcp`].data.slice().reverse(),y=n[`${a}-${s}-iocp-schannel`][`${c}-quic`].data.slice().reverse(),I=n[`${o}-${s}-epoll-openssl`][`${c}-tcp`].data.slice().reverse(),L=n[`${o}-${s}-epoll-openssl`][`${c}-quic`].data.slice().reverse(),P=n[`${a}-${s}-xdp-schannel`][`${c}-quic`].data.slice().reverse(),T=n[`${a}-${s}-wsk-schannel`][`${c}-quic`].data.slice().reverse(),W=e.jsx(k,{title:"Detailed Latency",subheader:`Tested using ${a}, ${o}, taking the min of P0 of 3 runs. `,labels:V,map:l=>(E&&(window.location.href=`https://github.com/microsoft/msquic/commit/${p[l][0]}`),`<div style = "margin: 10px">

         <p> <b> Build date: </b> ${p[l][3]} </p>
         <p> <b> Specific Windows / Linux OS versions this test ran on: </b> ${p[l][2]},  ${Q[l][2]} </p>
         <p> <b> Commit hash: </b> <a href="google.com"> ${p[l][0]} </a> </p>

         <p> <b> TCP + iocp: </b> ${$[l]&&$[l][5+t]}, </p>
         <p> <b> QUIC + iocp: </b> ${y[l]&&y[l][5+t]}, </p>
         <p> <b> TCP + epoll: </b> ${I[l]&&I[l][5+t]}, </p>
         <p> <b> QUIC + epoll: </b> ${L[l]&&L[l][5+t]}, <b> QUIC + winXDP: </b> ${P[l]&&P[l][5+t]}, <b> QUIC + wsk: </b> ${T[l]&&T[l][5+t]} </p>
      </div>`),series:[{name:"TCP + iocp",type:"line",fill:"solid",data:$.map(l=>l[5+t])},{name:"QUIC + iocp",type:"line",fill:"solid",data:y.map(l=>l[5+t])},{name:"TCP + epoll",type:"line",fill:"solid",data:I.map(l=>l[5+t])},{name:"QUIC + epoll",type:"line",fill:"solid",data:L.map(l=>l[5+t])},{name:"QUIC + winXDP",type:"line",fill:"solid",data:P.map(l=>l[5+t])},{name:"QUIC + wsk",type:"line",fill:"solid",data:T.map(l=>l[5+t])}]}));const _=l=>{h(l.target.value)},O=l=>{x(l.target.value)},M=l=>{r(l.target.value)},z=l=>{b(l.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx("title",{children:" Netperf "})}),e.jsxs(X,{maxWidth:"xl",children:[e.jsx(B,{variant:"h3",sx:{mb:5},children:"Detailed Latency"}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx(v,{sx:{},children:e.jsxs(f,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Context"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:s,label:"Context",onChange:_,defaultValue:0,children:[e.jsx(m,{value:"azure",children:"azure"}),a!=="windows-2025-x64"&&e.jsx(m,{value:"lab",children:"lab"})]})]})}),e.jsx(v,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(f,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Windows Environment"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a,label:"Windows Environment",onChange:O,defaultValue:0,children:[e.jsx(m,{value:"windows-2022-x64",children:"windows-2022-x64"}),s==="azure"&&e.jsx(m,{value:"windows-2025-x64",children:"windows-2025-x64"})]})]})}),e.jsx(v,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(f,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Linux Environment"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:o,label:"Linux Environment",onChange:M,defaultValue:0,children:e.jsx(m,{value:"ubuntu-20.04-x64",children:"ubuntu-20.04-x64"})})]})}),e.jsx(v,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(f,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Test type"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:c,label:"Upload or download",onChange:z,defaultValue:0,children:e.jsx(m,{value:"rps-up-512-down-4000",children:"512 Kb upload, 4000 Kb download"})})]})}),e.jsx(v,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(f,{fullWidth:!0,children:[e.jsx(j,{id:"demo-simple-select-label",children:"Percentile"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t,label:"Percentile",onChange:w,defaultValue:0,children:i.map((l,g)=>e.jsx(m,{value:g,children:l}))})]})})]}),e.jsx("br",{}),e.jsx(D,{container:!0,spacing:3,children:W}),e.jsx(v,{sx:{minWidth:120,margin:"10px"},children:e.jsxs(f,{fullWidth:!0,children:[e.jsx(j,{id:"demo-simple-select-label",children:"Full Latency Curve Commit"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:q,label:"Full Latency Curve Commit",onChange:F,defaultValue:0,children:p.slice().reverse().map((l,g)=>e.jsxs(m,{value:g,children:[p.length-g-1," ----- ",l[0]]}))})]})}),e.jsx(D,{container:!0,spacing:3,children:e.jsx(K,{tcpiocp:$,quiciocp:y,tcpepoll:I,quicepoll:L,quicxdp:P,quicwsk:T,commitIndex:q})})]})]})}export{Z as default};
