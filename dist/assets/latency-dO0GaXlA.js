import{r as u,j as e,H as M,T as B,B as f}from"./index-c3_y7fsq.js";import{G as D}from"./graph-view-87FEuB7-.js";import{u as R}from"./use-fetch-data-UkDCMiaX.js";import{C as X}from"./Container-Fb63Aspa.js";import{F as v,I as j,S as C,M as m}from"./Select-Ww2W58zu.js";import{G as k}from"./app-website-visits-86J1CYrj.js";const H=Q=>{const{tcpiocp:n,quiciocp:s,tcpepoll:h,quicepoll:i,quicxdp:x,quicwsk:c,commitIndex:r}=Q,o=["TCP + iocp","QUIC + iocp","TCP + epoll","QUIC + epoll","QUIC + winXDP","QUIC + wsk"],[b,T]=u.useState([]);let q=e.jsx("div",{});if(u.useEffect(()=>{console.log("FullLatCurve component mounted");const a=async(d,S)=>{try{const F=`https://raw.githubusercontent.com/microsoft/netperf/sqlite/full_latencies/full_curve_${d[S][1]}.json`;return await(await fetch(F)).json()}catch(U){return console.log(U),{Values:[],Percentiles:[]}}};n&&s&&h&&i&&x&&c&&(async()=>{const d=await Promise.all([a(n,n.length-r-1),a(s,s.length-r-1),a(h,h.length-r-1),a(i,i.length-r-1),a(x,x.length-r-1),a(c,c.length-r-1)]);T(d)})()},[n,s,h,i,x,c,r]),console.log(b),b){let a=[];for(let t of b)if(t.Percentiles.length>0){a=t.Percentiles,a=a.map(d=>d.toString());break}console.log(a),q=e.jsx(D,{title:"Full Curve Latency",subheader:"Tested using ,, taking the min of P0 of 3 runs. ",labels:a,series:b.map((t,d)=>({name:o[d],type:"line",fill:"solid",data:t.Values}))})}return e.jsx(u.Fragment,{children:q})},K=H;let E=!1;document.addEventListener("mousedown",function(){E=!0});document.addEventListener("mouseup",function(){E=!1});function le(){const Q="https://raw.githubusercontent.com/microsoft/netperf/deploy/historical_latency_page.json",{data:n}=R(Q),[s,h]=u.useState("azure"),[i,x]=u.useState("windows-2022-x64"),[c,r]=u.useState("ubuntu-20.04-x64"),[o,b]=u.useState("rps-up-512-down-4000"),[T,q]=u.useState(0),a=["50th percentile","90th percentile","99th percentile","99.9th percentile","99.99th percentile","99.999th percentile","99.9999th percentile"],[t,d]=u.useState(0),S=l=>{d(l.target.value)},U=l=>{q(l.target.value)};let F=e.jsx("div",{}),p=[],W=[],V=[],w=[],$=[],y=[],I=[],L=[],P=[];n&&(p=n[`${i}-${s}-iocp-schannel`][`${o}-tcp`].data.slice().reverse(),W=n[`${c}-${s}-epoll-openssl`][`${o}-tcp`].data.slice().reverse(),V=Array.from({length:Math.max(p.length,W.length)},(l,g)=>g),w=n[`${i}-${s}-iocp-schannel`][`${o}-tcp`].data.slice().reverse(),$=n[`${i}-${s}-iocp-schannel`][`${o}-quic`].data.slice().reverse(),y=n[`${c}-${s}-epoll-openssl`][`${o}-tcp`].data.slice().reverse(),I=n[`${c}-${s}-epoll-openssl`][`${o}-quic`].data.slice().reverse(),L=n[`${i}-${s}-xdp-schannel`][`${o}-quic`].data.slice().reverse(),P=n[`${i}-${s}-wsk-schannel`][`${o}-quic`].data.slice().reverse(),F=e.jsx(D,{title:"Detailed Latency",subheader:`Tested using ${i}, ${c}, taking the min of P0 of 3 runs. `,labels:V,map:l=>(E&&(window.location.href=`https://github.com/microsoft/msquic/commit/${p[l][0]}`),`<div style = "margin: 10px">

         <p> <b> Build date: </b> ${p[l][3]} </p>
         <p> <b> Specific Windows / Linux OS versions this test ran on: </b> ${p[l][2]},  ${W[l][2]} </p>
         <p> <b> Commit hash: </b> <a href="google.com"> ${p[l][0]} </a> </p>

         <p> <b> TCP + iocp: </b> ${w[l]&&w[l][5+t]}, </p>
         <p> <b> QUIC + iocp: </b> ${$[l]&&$[l][5+t]}, </p>
         <p> <b> TCP + epoll: </b> ${y[l]&&y[l][5+t]}, </p>
         <p> <b> QUIC + epoll: </b> ${I[l]&&I[l][5+t]}, <b> QUIC + winXDP: </b> ${L[l]&&L[l][5+t]}, <b> QUIC + wsk: </b> ${P[l]&&P[l][5+t]} </p>
      </div>`),series:[{name:"TCP + iocp",type:"line",fill:"solid",data:w.map(l=>l[5+t])},{name:"QUIC + iocp",type:"line",fill:"solid",data:$.map(l=>l[5+t])},{name:"TCP + epoll",type:"line",fill:"solid",data:y.map(l=>l[5+t])},{name:"QUIC + epoll",type:"line",fill:"solid",data:I.map(l=>l[5+t])},{name:"QUIC + winXDP",type:"line",fill:"solid",data:L.map(l=>l[5+t])},{name:"QUIC + wsk",type:"line",fill:"solid",data:P.map(l=>l[5+t])}]}));const _=l=>{h(l.target.value)},O=l=>{x(l.target.value)},z=l=>{r(l.target.value)},G=l=>{b(l.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsx("title",{children:" Netperf "})}),e.jsxs(X,{maxWidth:"xl",children:[e.jsx(B,{variant:"h3",sx:{mb:5},children:"Detailed Latency"}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx(f,{sx:{},children:e.jsxs(v,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Context"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:s,label:"Context",onChange:_,defaultValue:0,children:[e.jsx(m,{value:"azure",children:"azure"}),i!=="windows-2025-x64"&&e.jsx(m,{value:"lab",children:"lab"})]})]})}),e.jsx(f,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(v,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Windows Environment"}),e.jsxs(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i,label:"Windows Environment",onChange:O,defaultValue:0,children:[e.jsx(m,{value:"windows-2022-x64",children:"windows-2022-x64"}),s==="azure"&&e.jsx(m,{value:"windows-2025-x64",children:"windows-2025-x64"})]})]})}),e.jsx(f,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(v,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Linux Environment"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:c,label:"Linux Environment",onChange:z,defaultValue:0,children:e.jsx(m,{value:"ubuntu-20.04-x64",children:"ubuntu-20.04-x64"})})]})}),e.jsx(f,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(v,{children:[e.jsx(j,{id:"demo-simple-select-label",children:"Test type"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:o,label:"Upload or download",onChange:G,defaultValue:0,children:e.jsx(m,{value:"rps-up-512-down-4000",children:"512 Kb upload, 4000 Kb download"})})]})}),e.jsx(f,{sx:{minWidth:120,marginLeft:"10px"},children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(j,{id:"demo-simple-select-label",children:"Percentile"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t,label:"Percentile",onChange:S,defaultValue:0,children:a.map((l,g)=>e.jsx(m,{value:g,children:l}))})]})})]}),e.jsx("br",{}),e.jsx(k,{container:!0,spacing:3,children:F}),e.jsx(f,{sx:{minWidth:120,margin:"10px"},children:e.jsxs(v,{fullWidth:!0,children:[e.jsx(j,{id:"demo-simple-select-label",children:"Full Latency Curve Commit"}),e.jsx(C,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:T,label:"Full Latency Curve Commit",onChange:U,defaultValue:0,children:p.slice().reverse().map((l,g)=>e.jsxs(m,{value:g,children:[p.length-g-1," ----- ",l[0]]}))})]})}),e.jsx(k,{container:!0,spacing:3,children:e.jsx(K,{tcpiocp:w,quiciocp:$,tcpepoll:y,quicepoll:I,quicxdp:L,quicwsk:P,commitIndex:T})})]})]})}export{le as default};
